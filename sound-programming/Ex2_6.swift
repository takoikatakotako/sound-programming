import Foundation


// ハミング窓を適用して周波数分析を行う
func ex2_6(filePath: String) {
    let pcm0 = monoWaveRead(filePath: filePath)
    
    let N: Int = 64
    var xReal: [Double] = [Double](repeating: 0, count: N)
    var xImag: [Double] = [Double](repeating: 0, count: N)
    var XReal: [Double] = [Double](repeating: 0, count: N)
    var XImag: [Double] = [Double](repeating: 0, count: N)
    
    var wReal: Double
    var wImag: Double
    
    let w: [Double] = hanningWindow(N: N)
        
    for n in 0..<N {
        // x(n)の実数部
        xReal[n] = pcm0.s[n] * w[n]
        // x(n)の虚数部
        xImag[n] = 0.0
    }
    
    // DFT
    for k in 0..<N {
        for n in 0..<N {
            wReal = cos(2.0 * Double.pi * Double(k) * Double(n) / Double(N) )
            wImag = -sin(2.0 * Double.pi * Double(k) * Double(n) / Double(N) )
            // X(k)の実数部
            XReal[k] += wReal * xReal[n] - wImag * xImag[n]
            // X(k)の虚数部
            XImag[k] += wReal * xImag[n] + wImag * xReal[n]
        }
    }
    
    // 周波数特性
    for k in 0..<N {
        print("\(k) \(XReal[k]) + \(XImag[k])")
    }
}

//0 0.000000+j0.000000
//1 -0.000000+j1.999988
//2 0.000000+j-3.999976
//3 -0.000000+j1.999988
//4 -0.000000+j-0.000000
//5 -0.000000+j-0.000016
//6 -0.000000+j0.000032
//7 0.000000+j-0.000016
//8 0.000000+j-0.000000
//9 -0.000000+j0.000022
//10 0.000000+j-0.000045
//11 -0.000000+j0.000022
//12 0.000000+j-0.000000
//13 0.000000+j-0.000056
//14 -0.000000+j0.000113
//15 0.000000+j-0.000056
//16 0.000000+j0.000000
//17 0.000000+j0.000021
//18 -0.000000+j-0.000043
//19 0.000000+j0.000021
//20 0.000000+j0.000000
//21 0.000000+j0.000029
//22 -0.000000+j-0.000058
//23 -0.000000+j0.000029
//24 0.000000+j0.000000
//25 -0.000000+j-0.000075
//26 -0.000000+j0.000150
//27 -0.000000+j-0.000075
//28 0.000000+j-0.000000
//29 0.000000+j0.000000
//30 -0.000000+j-0.000000
//31 0.000000+j0.000000
//32 -0.000000+j-0.000000
//33 -0.000000+j-0.000000
//34 -0.000000+j0.000000
//35 0.000000+j-0.000000
//36 0.000000+j-0.000000
//37 0.000000+j0.000075
//38 -0.000000+j-0.000150
//39 0.000000+j0.000075
//40 0.000000+j-0.000000
//41 0.000000+j-0.000029
//42 0.000000+j0.000058
//43 -0.000000+j-0.000029
//44 0.000000+j0.000000
//45 0.000000+j-0.000021
//46 0.000000+j0.000043
//47 -0.000000+j-0.000021
//48 -0.000000+j0.000000
//49 0.000000+j0.000056
//50 0.000000+j-0.000113
//51 0.000000+j0.000056
//52 -0.000000+j-0.000000
//53 -0.000000+j-0.000022
//54 0.000000+j0.000045
//55 0.000000+j-0.000022
//56 0.000000+j0.000000
//57 -0.000000+j0.000016
//58 0.000000+j-0.000032
//59 0.000000+j0.000016
//60 0.000000+j-0.000000
//61 0.000000+j-1.999988
//62 -0.000000+j3.999976
//63 0.000000+j-1.999988

